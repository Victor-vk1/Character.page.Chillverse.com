 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Character Selection</title>
<style>
  /* Reset & body */
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #0d0d0f, #1a1a24);
    color:#fff;
    overflow-x:hidden;
    display:flex; justify-content:center; align-items:center;
    height:100vh;
  }

  /* Water sliding overlay */
  .water-slide {
    position: fixed;
    top: -100%;
    left: 0;
    width: 100%; height: 100%;
    background: rgba(0,200,255,0.1);
    backdrop-filter: blur(2px);
    z-index:10;
    pointer-events:none;
    animation: slideWater 10s linear forwards;
  }
  @keyframes slideWater { 0%{top:-100%;} 100%{top:0;} }

  /* Glass UI */
  .glass-ui {
    position: relative;
    display:flex; justify-content:space-between; align-items:center;
    width:85%; max-width:1000px;
    padding:25px;
    border-radius:20px;
    border:1px solid rgba(0,255,255,0.3);
    background: rgba(255,255,255,0.05);
    backdrop-filter: blur(25px);
    box-shadow: 0 0 30px rgba(0,255,255,0.2);
    opacity:0;
    transform: translateY(50px);
    transition: all 1s ease;
    z-index:20;
  }
  .glass-ui.show { opacity:1; transform: translateY(0); }

  /* Left card */
  .card {
    width:220px; height:320px;
    border-radius:20px;
    overflow:hidden;
    border:2px solid rgba(0,255,255,0.5);
    animation: spinTilt 20s linear infinite;
    display:flex; justify-content:center; align-items:center;
    background:#111;
  }
  .card img { width:100%; height:100%; object-fit:cover; border-radius:20px; }

  @keyframes spinTilt {
    0% { transform: rotateY(0deg) rotateZ(-2deg); }
    25% { transform: rotateY(90deg) rotateZ(2deg); }
    50% { transform: rotateY(180deg) rotateZ(-2deg); }
    75% { transform: rotateY(270deg) rotateZ(2deg); }
    100% { transform: rotateY(360deg) rotateZ(-2deg); }
  }

  /* Right info panel */
  .info-panel { width:55%; padding-left:25px; }
  .info-panel h2{ margin-bottom:10px; font-size:26px; text-shadow:0 0 8px #0ff;}
  .info-panel p{ margin:5px 0; font-size:16px; }
  .select-btns button, .element-btns button {
    margin:5px; padding:10px 18px;
    border:none; border-radius:12px; cursor:pointer;
    background: rgba(0,255,255,0.15); color:#0ff; font-weight:500;
    transition:0.3s;
  }
  .select-btns button:hover, .element-btns button:hover{
    background: rgba(0,255,255,0.35);
    box-shadow:0 0 10px #0ff;
  }

  /* Collapsible element */
  .collapsible {
    background: rgba(0,255,255,0.1);
    color:#0ff; cursor:pointer;
    padding:10px; width:100%;
    border:none; text-align:left;
    outline:none; font-size:16px; margin-top:15px; border-radius:10px;
    transition:0.3s;
  }
  .active, .collapsible:hover { background: rgba(0,255,255,0.3); }
  .content { padding:0 10px; display:none; overflow:hidden; margin-top:5px; }

</style>
</head>
<body>

<div class="water-slide"></div>

<div class="glass-ui" id="glassUI">
  <div class="card" id="battleCard">
    <img id="charImg" src="" alt="Character">
  </div>
  <div class="info-panel">
    <div class="select-btns" id="selectBtns">
      <button data-char="Vale" data-gender="Male">Vale</button>
      <button data-char="Nerya" data-gender="Female">Nerya</button>
      <button data-char="Yin" data-gender="Male">Yin</button>
      <button data-char="Mizuki" data-gender="Female">Mizuki</button>
      <button data-char="Chasca" data-gender="Female">Chasca</button>
    </div>

    <div id="infoCard" style="display:none;">
      <h2 id="charName"></h2>
      <p id="charGender"></p>
      <p id="charStatus">Status: Normal Character</p>
      <p id="charBirthday"></p>

      <button type="button" class="collapsible">Select Element</button>
      <div class="content element-btns">
        <button data-element="Pyro">Pyro</button>
        <button data-element="Hydro">Hydro</button>
        <button data-element="Electro">Electro</button>
        <button data-element="Cryo">Cryo</button>
        <button data-element="Geo">Geo</button>
      </div>
    </div>
  </div>
</div>

<script>
  const glassUI = document.getElementById("glassUI");
  const selectBtnsDiv = document.getElementById("selectBtns");
  const infoCard = document.getElementById("infoCard");
  const charName = document.getElementById("charName");
  const charGender = document.getElementById("charGender");
  const charBirthday = document.getElementById("charBirthday");
  const charImg = document.getElementById("charImg");
  const collapsible = document.querySelector(".collapsible");
  const elementBtnsDiv = document.querySelector(".element-btns");

  const charImages = {
    "Vale":"images/vale.png",
    "Nerya":"images/nerya.png",
    "Yin":"images/yin.png",
    "Mizuki":"images/mizuki.png",
    "Chasca":"images/chasca.png"
  };

  const spreadsheetURL = "https://script.google.com/macros/s/AKfycbwg93tznZiuwkRkX_ORiVoubRRYGqI2jwuQHbhPPb0zqstDU3bBwiqR9tbS2W_1-fkK/exec";

  // Show glass UI after 10 sec
  setTimeout(()=> { glassUI.classList.add("show"); }, 10000);

  // Fetch username from daily reward page
  const username = localStorage.getItem("username") || "Guest";

  // Check if character already chosen
  const playerData = JSON.parse(localStorage.getItem("playerData"));
  if(playerData){
    showSelectedCharacter(playerData.character, playerData.gender, playerData.element);
  }

  // Character selection
  selectBtnsDiv.querySelectorAll("button").forEach(btn=>{
    btn.addEventListener("click",()=>{
      const character = btn.getAttribute("data-char");
      const gender = btn.getAttribute("data-gender");
      const birthday = "2000-01-"+Math.floor(Math.random()*28+1);
      charName.textContent = character;
      charGender.textContent = "Gender: " + gender;
      charBirthday.textContent = "Birthday: " + birthday;
      charImg.src = charImages[character];

      selectBtnsDiv.style.display="none";
      infoCard.style.display="block";

      localStorage.setItem("playerData", JSON.stringify({character, gender, birthday}));
    });
  });

  // Collapsible element selection
  collapsible.addEventListener("click", function(){
    this.classList.toggle("active");
    const content = this.nextElementSibling;
    content.style.display=(content.style.display==="block") ? "none":"block";
  });

  // Element selection buttons
  elementBtnsDiv.querySelectorAll("button").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const element = btn.getAttribute("data-element");
      btn.style.background="rgba(0,255,255,0.5)";
      btn.style.pointerEvents="none";

      const savedData = JSON.parse(localStorage.getItem("playerData"));
      savedData.element = element;
      localStorage.setItem("playerData", JSON.stringify(savedData));

      // Send to Google Spreadsheet
      fetch(spreadsheetURL, {
        method:"POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({
          username: username,
          character: savedData.character,
          element: element
        })
      }).then(res=>res.json())
      .then(data=>console.log("Saved to sheet:", data))
      .catch(err=>console.error(err));

      elementBtnsDiv.style.display="none";
      collapsible.style.display="none";
    });
  });

  function showSelectedCharacter(character, gender, element){
    charName.textContent = character;
    charGender.textContent = "Gender: " + gender;
    charBirthday.textContent = JSON.parse(localStorage.getItem("playerData")).birthday;
    charImg.src = charImages[character];
    selectBtnsDiv.style.display="none";
    infoCard.style.display="block";

    if(element){
      collapsible.style.display="none";
      elementBtnsDiv.style.display="none";
    }
  }
</script>
</body>
</html>
